---
layout: page-with-side-nav
title: F2173 - Registreer klantcontact
date: 12-12-2022
---

# F2173 - Registreer klantcontact

## Inleiding

Hoe het klantcontact wordt geregistreerd hangt samen met de wijze van het toekennen van de ID's. 
Dit vraagstuk staat beschreven in [V6577](./6577.md)

Vooralsnog gaan we ervan uit dat de ID wordt toegekend door de provider. 

## Functionaliteit

De functie registreert een nieuwe `partij` en de daarbij behorende `partij-identificator`. 
Aangezien de `partij-identificator` pas kan worden vastgelegd als de ID van de `Partij` bekend is is er niet te ontkomen aan tijdelijke inconsistentie. 
Met de huidige wijze van toekennen van ID's (door de provider) zal eerst de `partij` vastgelegd moeten worden voordat de `partij-identificator` kan worden vastgelegd met de verwijzing naar de `partij`.

Een `partij` kan niet bestaan zonder dat er een `partij-identificator` bestaat. Zolang de `partij-identificator` dus niet is vastgelegd (met de juiste "identificeerdePartij" property) is er sprake van een inconsitentie.


## Functionaliteit

De functie registreert een nieuw `klantcontact` inclusief van de bijbehorende verplicht gerelateerde objecten:
- minimaal 1 `betrokkeneBijKlantcontact`
- minimaal 1 `actorKlantcontact`

Aangezien de `actorKlantcontact` en `betrokkeneBijKlantcontact` pas kunnen worden vastgelegd als de *id* van het `klantcontact` bekend is is er niet te ontkomen aan tijdelijke inconsistentie. 
Met de huidige wijze van toekennen van ID's (door de provider) zal eerst het `klantcontact` vastgelegd moeten worden voordat `actorKlantcontact` en `betrokkeneBijKlantcontact` kunnen worden vastgelegd met de verwijzing naar het `klantcontact`.

Een `klantcontact` kan niet bestaan zonder dat er een gerelateerde `actorKlantcontact` en `betrokkeneBijKlantcontact` bestaan. Zolang de `actorKlantcontact` (met het juiste *klantcontactId*) en de `betrokkeneBijKlantcontact` (met de juiste *hadKlantcontact*) is er sprake van een inconsitentie.

Vastleggen relatie naar `actor` Uitgangspunt bij het vastleggen van het `klantcontact` is dat de consumer-applicatie weet welke `actor` betrokken is bij het `klantcontact` doordat de medewerker ia ingelogd. 
Deze `actor` wordt automatisch aan het `klantcontact` gekoppeld door de consumer-applicatie. 

Mochten er meer medewerkers bij een `klantcontact`, bijvoorbeeld bij een gesprek, betrokken zijn, dan kunnen die `actoren` handmatig in de consumer-applicatie geselecteerd worden om ook vastgelegd tw worden. Het vastleggen van deze aanvullende medewerkers als `actor` gebeurt via de functie [F6542 - Koppel Actor aan Klantcontact](./6542.md).

Het vastleggen van de `betrokkeneBijKlantcontact` kan in een aantal varianten gebeuren. 
- Indien de partij reeds bekend:
  - Wordt er een `betrokkeneBijKlantcontact` vastgelegd waarin, naast specifieke gegevens van de betrokkenheid, de relatie tussen het `klantcontact` naar deze `partij` wordt vastgelegd. 
- Indien er geen sprake is van contact met een bekende `partij`:
  - Er wordt aan de klant (of contactpersoon van de klant) gevraagd of de gegevens die worden aangeleverd worden in de toekomst mogen worden hergebruikt.
  - Als de klant daarmee instemt wordt er met de aangeleverde gegevens een `partij` aangemaakt conform [F5444 - Registreer partij](./7554.md) en wordt er vervolgens een `betrokkeneBijKlantcontact` vastgelegd waarin, naast specifieke gegevens van de betrokkenheid, de relatie tussen het `klantcontact` naar deze `partij` wordt vastgelegd. 
  - Als de klant niet instemt met hergebruik in de toekomst worden de aangeleverde gegevens vastgelegd in de `betrokkeneBijKlantcontact`.

Mochten er meer betrokkenen zijn bij een `klantcontact`, bijvoorbeeld bij een gesprek, betrokken zijn, dan kunnen vastgelegd worden met de functie [F2599 - Registreer betrokkene bij klantcontact](./6542.md).

## Vastleggen `klantcontact`

### API-Call

post ../klantcontacten

### Requestbody

| Objecttype - Attribuut | Voorbeeld waarde | Toelichting |
| :----------- | :----------- | :----------- |
| `Klantcontact` | | |
| - `nummer` | 23009182 | Controle op uniciteit door de provider |
| - `codeKanaal` | Telefoon | Automatisch ingevuld door condumer | 
| - `onderwerp` | Afvalinzameling rond kerst | |
| - `inhoud` | Klant vraagt wanneer afval van klant wordt opgehaald. Normaal gesproken op maandag opgehaald. Dit jaar valt 1e kerstdag op maandag. Antwoord: Aangegeven dat het afval de zaterdag voorafgaand aan de maandag aangeboden kan worden. | |
| - `initiator` | Klant | Automatisch ingevuld door consumer |
| - `indicatieContactGelukt` | Ja | Automatisch gevuld door consumer |
| - `codeTaal` | 'Nederlands` | Prefill door consumer wijzigbaar door gebruiker |
| - `vertrouwelijk` | Nee | Prefill door consumer wijzigbaar door gebruiker |
| - `plaatsgevondenOp` | 01-03-2023 10:00 | Prefill door consumer wijzigbaar door gebruiker |

### Responsebody 

| Objecttype - Attribuut | Voorbeeld waarde | Toelichting |
| :----------- | :----------- | :----------- |
| `Klantcontact` | | |
| - `id` | 5452f450-e940-4996-a353-37f4a7ec8710 | Automatisch ingevuld door provider |
| - `nummer` | 23009182 | Automatisch ingevuld door provider |
| - `codeKanaal` | Telefoon | Automatisch ingevuld door condumer | 
| - `onderwerp` | Afvalinzameling rond kerst | |
| - `inhoud` | Klant vraagt wanneer afval van klant wordt opgehaald. Normaal gesproken op maandag opgehaald. Dit jaar valt 1e kerstdag op maandag. Antwoord: Aangegeven dat het afval de zaterdag voorafgaand aan de maandag aangeboden kan worden. | |
| - `initiator` | Klant | Automatisch ingevuld door consumer |
| - `indicatieContactGelukt` | Ja | Automatisch gevuld door consumer |
| - `codeTaal` | 'Nederlands` | Prefill door consumer wijzigbaar door gebruiker |
| - `vertrouwelijkheid` | Nee | Prefill door consumer wijzigbaar door gebruiker |
| - `plaatsgevondenOp` | 01-03-2023 10:00 | Prefill door consumer wijzigbaar door gebruiker |

## Vastleggen `actorKlantcontact`

### API-Call

post ../actorKlantcontacten

### Requestbody

| Objecttype - Attribuut | Voorbeeld waarde | Toelichting |
| :----------- | :----------- | :----------- |
| `ActorKlantcontact` | | |
| - `id` | 5452f450-e940-4996-a353-37f4a7ec8710 | Automatisch ingevuld door provider |
| - `actorId` | 23009182 | Automatisch ingevuld door provider |
| - `klantcontactId` | Telefoon | Automatisch ingevuld door consumer | 

[^1]: Indien een bijlage is opgegeven wordt hiervoor eerst een nieuw `informatieobject` gemaakt.
Vervolgens wordt een `bijlage` gemaakt die het `klantcontact` aan de `bijlage` en het `informatieobject` koppelt.

Beschrijven we hier de saga? Zie vraagstuk [V8786](./8786.md).

## API call

| API Stijl | Aanroep |
| :--- | :--- |
| REST | |
| GraphQL | |
| gRPC | |
